<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19910305</article-id><article-id pub-id-type="pmc">2804298</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btp635</article-id><article-id pub-id-type="publisher-id">btp635</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Target prediction and a statistical sampling algorithm for RNA&#x02013;RNA interaction</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Fenix W. D.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Qin</surname><given-names>Jing</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Reidys</surname><given-names>Christian M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Stadler</surname><given-names>Peter F.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3&#x02013;8</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup> Center for Combinatorics, LPMC-TJKLC, <sup>2</sup> College of Life Science, Nankai University, Tianjin 300071, P. R. China, <sup>3</sup> Bioinformatics Group, Department of Computer Science, <sup>4</sup> Interdisciplinary Center for Bioinformatics, University of Leipzig, H&#x000e4;rtelstrasse 16-18, D-04107 Leipzig, <sup>5</sup> Max Planck Institute for Mathematics in the Sciences, Inselstrasse 22, <sup>6</sup> RNomics Group, Fraunhofer Institut for Cell Therapy and Immunology, Perlickstra&#x000df;e 1, D-04103 Leipzig, Germany, <sup>7</sup> Institute for Theoretical Chemistry, University of Vienna, W&#x000e4;hringerstrasse 17, A-1090 Vienna, Austria and <sup>8</sup> The Santa Fe Institute, 1399 Hyde Park Rd., Santa Fe, NM, USA</aff><author-notes><corresp id="COR1">* To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Ivo Hofacker</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>1</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>13</day><month>11</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>11</month><year>2009</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>26</volume><issue>2</issue><fpage>175</fpage><lpage>181</lpage><history><date date-type="received"><day>9</day><month>9</month><year>2009</year></date><date date-type="rev-recd"><day>4</day><month>11</month><year>2009</year></date><date date-type="accepted"><day>5</day><month>11</month><year>2009</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2009. Published by Oxford University Press.</copyright-statement><copyright-year>2009</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Motivation:</bold> It has been proven that the accessibility of the target sites has a critical influence on RNA&#x02013;RNA binding, in general and the specificity and efficiency of miRNAs and siRNAs, in particular. Recently, <italic>O</italic>(<italic>N</italic><sup>6</sup>) time and <italic>O</italic>(<italic>N</italic><sup>4</sup>) space dynamic programming (DP) algorithms have become available that compute the partition function of RNA&#x02013;RNA interaction complexes, thereby providing detailed insights into their thermodynamic properties.</p><p><bold>Results:</bold> Modifications to the grammars underlying earlier approaches enables the calculation of interaction probabilities for any given interval on the target RNA. The computation of the &#x02018;hybrid probabilities&#x02019; is complemented by a stochastic sampling algorithm that produces a Boltzmann weighted ensemble of RNA&#x02013;RNA interaction structures. The sampling of <italic>k</italic> structures requires only negligible additional memory resources and runs in <italic>O</italic>(<italic>k</italic>&#x000b7;<italic>N</italic><sup>3</sup>).</p><p><bold>Availability:</bold> The algorithms described here are implemented in C as part of the <monospace>rip</monospace> package. The source code of <monospace>rip2</monospace> can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.combinatorics.cn/cbpc/rip.html">http://www.combinatorics.cn/cbpc/rip.html</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/rip.html">http://www.bioinf.uni-leipzig.de/Software/rip.html</ext-link>.</p><p><bold>Contact:</bold> <email>duck@santafe.edu</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>RNA&#x02013;RNA binding is a major mode of action of various classes of non-coding RNAs and plays a crucial role in many regulatory processes in all living organisms. Examples include the regulation of translation in both prokaryotes (Narberhaus and Vogel, <xref ref-type="bibr" rid="B26">2007</xref>) and eukaryotes (Banerjee and Slack, <xref ref-type="bibr" rid="B6">2002</xref>; McManus and Sharp, <xref ref-type="bibr" rid="B22">2002</xref>), the targeting of chemical modifications (Bachellerie <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2002</xref>), insertion editing (Benne, <xref ref-type="bibr" rid="B7">1992</xref>) and transcriptional control (Kugel and Goodrich, <xref ref-type="bibr" rid="B20">2007</xref>). Emerging evidence suggests, furthermore, that RNA&#x02013;RNA interactions also play a role for the functionality of long mRNA-like ncRNAs (Hekimoglu and Ringrose, <xref ref-type="bibr" rid="B17">2009</xref>). A common theme in many RNA classes, including miRNAs, snRNAs, gRNAs, snoRNAs and in particular many of the procaryotic small RNAs, is the formation of RNA&#x02013;RNA interaction structures that are much more complex than simple complementary sense&#x02013;antisense interactions. Thermodynamically, the binding of two RNA molecules <italic>A</italic> and <italic>B</italic> can be described by the binding energy &#x00394;<italic>G</italic><sup>bind</sup> = <italic>G</italic><sub><italic>AB</italic></sub> &#x02212; <italic>G</italic><sub><italic>A</italic></sub> &#x02212; <italic>G</italic><sub><italic>B</italic></sub>, i.e. by the difference of the energy of structure formation <italic>G</italic><sub><italic>AB</italic></sub> of the <italic>AB</italic> complex and the folding energies <italic>G</italic><sub><italic>A</italic></sub> and <italic>G</italic><sub><italic>B</italic></sub> of the two individual RNAs <italic>A</italic> and <italic>B</italic>. Thus, the binding or hybridization energy has been widely used as a criterion to predict RNA&#x02013;RNA interactions (Busch <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>; Rehmsmeier <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">2004</xref>; Tjaden <italic>et al.</italic>, <xref ref-type="bibr" rid="B34">2006</xref>).</p><p>The interaction between two RNAs is governed by the same physical principles that determine RNA folding: the formation of specific base pairing patterns whose energy is largely determined by base pair stacking and loop strains. Secondary structures, therefore, are an appropriate level of description to quantitatively understand the thermodynamics of RNA&#x02013;RNA binding. Just as the general RNA folding problem with unrestricted pseudoknots (Akutsu, <xref ref-type="bibr" rid="B1">2000</xref>), the RNA&#x02013;RNA interaction problem (RIP) is Non-Polynomial (NP)-complete in its most general form (Alkan <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2006</xref>; Mneimneh, <xref ref-type="bibr" rid="B23">2009</xref>). Polynomial-time algorithms can be derived, however, by restricting the space of allowed configurations in ways that are similar to pseudoknot folding algorithms (Rivas and Eddy, <xref ref-type="bibr" rid="B30">1999</xref>). The simplest approach concatenates two (or more) interacting sequences and then employs the standard secondary structure folding algorithm with a slightly modified energy model that treats loops containing cut-points as external elements. The software tools <monospace>RNAcofold</monospace> (Bernhart <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2006</xref>; Hofacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">1994</xref>), <monospace>pairfold</monospace> (Andronescu <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>) and <monospace>NUPACK</monospace> (Dirks <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2007</xref>) subscribe to this strategy. The main problem of this approach is that it cannot predict important motifs such as kissing-hairpin loops. The paradigm of concatenation has also been generalized to the pseudoknot folding algorithm of Rivas and Eddy (<xref ref-type="bibr" rid="B30">1999</xref>). The resulting model, however, still does not generate all relevant interaction structures (Chitsaz <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2009b</xref>; Qin and Reidys, <xref ref-type="bibr" rid="B28">2007</xref>). An alternative line of thought, implemented in <monospace>RNAduplex</monospace> and <monospace>RNAhybrid</monospace> (Rehmsmeier <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">2004</xref>), is to neglect all internal base pairings in either strand, i.e. to compute the minimum free energy (MFE) secondary structure of hybridization of otherwise unstructured RNAs. <monospace>RNAup</monospace> (M&#x000fc;ckstein <italic>et al.</italic>, <xref ref-type="bibr" rid="B24">2006</xref>, <xref ref-type="bibr" rid="B25">2008</xref>) and <monospace>intaRNA</monospace> (Busch <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>) restrict interactions to a single interval that remains unpaired in the secondary structure for each partner. As a special case, snoRNA/target complexes are treated more efficiently using a specialized tool (Tafer <italic>et al.</italic>, <xref ref-type="bibr" rid="B33">2009</xref>) due to the highly conserved interaction motif. Algorithmically, the approaches mentioned so far are close relatives of the RNA folding recursions given by Zuker and Sankoff (<xref ref-type="bibr" rid="B37">1984</xref>).</p><p>A different approach was taken independently by Pervouchine (<xref ref-type="bibr" rid="B27">2004</xref>) and Alkan <italic>et al.</italic> (<xref ref-type="bibr" rid="B2">2006</xref>), who proposed MFE folding algorithms for predicting the <italic>joint structure</italic> of two interacting RNA molecules. In this model, &#x0201c;joint structure&#x0201d; means that the intramolecular structures of each partner is pseudoknot free, the intermolecular binding pairs are non-crossing and there is no so-called &#x0201c;zig-zag&#x0201d; configuration (see below for details). The optimal joint structure can be computed in <italic>O</italic>(<italic>N</italic><sup>6</sup>) time and <italic>O</italic>(<italic>N</italic><sup>4</sup>) space by means of dynamic programming (DP). More recently, extensions to the partition function were proposed by Chitsaz <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2009b</xref>) (<monospace>piRNA</monospace>) and Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>) (<monospace>rip1</monospace>). In contrast with the RNA folding problem, where minimum energy folding and partition functions can be obtained by very similar algorithms, this is much more complicated for joint structures. The reason is that simple unambiguous grammars are known for RNA secondary structures (Dowell and Eddy, <xref ref-type="bibr" rid="B14">2004</xref>), while the disambiguation of grammar underlying the Alkan&#x02013;Pervouchine algorithm requires the introduction of a large number of additional non-terminals (which algorithmically translate into additional DP tables). Although the partition function of joint structures can be computed in <italic>O</italic>(<italic>N</italic><sup>6</sup>) time and <italic>O</italic>(<italic>N</italic><sup>4</sup>) space, the current implementations require very large computational resources. Salari <italic>et al.</italic> (<xref ref-type="bibr" rid="B31">2009</xref>) recently achieved a substantial speed-up making use of the observation that the external interactions mostly occur between pairs of unpaired regions of single structures. Chitsaz <italic>et al.</italic> (<xref ref-type="bibr" rid="B10">2009a</xref>), on the other hand, use tree-structured Markov random fields to approximate the joint probability distribution of multiple (&#x02265;3) contact regions.</p><p>The binding energies provides a useful overall characterization of an RNA&#x02013;RNA interaction. In many cases, however, the locations of the intermolecular base pairs and the detailed structure of the interaction complex is of crucial importance. Bacterial sRNAs, for example, may either up- or down-regulate mRNA translation depending on the structural changes induced by the interaction (Urban and Vogel, <xref ref-type="bibr" rid="B36">2007</xref>). In particular, in RNA&#x02013;RNA complexes with multiple interaction sites, i.e. in the class of structures for which the expensive computation of joint structures is necessary, one is interested in the probabilities of hybridization in individual regions and in the interdependencies of alternative conformations, see <xref ref-type="fig" rid="F1">Fig. 1</xref>. The probabilities of the individual building blocks of the DP recursions of Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>), furthermore, do not lend themselves to direct biophysical interpretations (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Examples of RNA-RNA interactions structures. The primary interaction region(s) are highlighted in grey in the experimentally supported structural models from the literature: (<bold>A</bold>) <italic>ompA</italic>-<italic>MicA</italic>: (Udekwu <italic>et al.</italic>, <xref ref-type="bibr" rid="B35">2005</xref>); (<bold>B</bold>) <italic>sodB</italic>-<italic>RyhB</italic>: (Geissmann and Touati, <xref ref-type="bibr" rid="B15">2004</xref>); (<bold>C</bold>) <italic>fhlA</italic>-<italic>OxyS</italic>: (Argaman and Altuvia, <xref ref-type="bibr" rid="B4">2000</xref>). Hybridization probabilities computed by <monospace>rip2</monospace> are annotated by black boxes for regions with a probability larger than 10%. In many cases, the computational predictions identify additional hybridization regions that may further stabilize the interaction.</p></caption><graphic xlink:href="btp635f1"/></fig>
</p><p>We therefore extend our previous framework in two directions: (i) A modification of the underlying grammar explicitly treats hybrids, i.e. maximal regions with exclusively intermolecular interactions. This allows us to investigate local aspects in much more detail. (ii) A stochastic bracktracing algorithm, in analogy to similar approaches for RNA secondary structure prediction (Ding and Lawrence, <xref ref-type="bibr" rid="B12">2003</xref>; Tacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B32">1996</xref>), which can be used to produce representative structure and to generate samples from the thermodynamic properties. These samples can be useful to assess complex structural features for which it would be too tedious or expensive to design and implement dedicated exact backtracing algorithms.</p></sec><sec id="SEC2"><title>2 THE HYBRID-PARTITION FUNCTION</title><sec id="SEC2.1"><title>2.1 Some basic facts</title><p>We briefly review some basic concepts and outline the notation introduced in Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>). Full details are given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link>.</p><p>Given two RNA sequences <italic>R</italic>=(<italic>R</italic><sub><italic>i</italic></sub>)<sub>1</sub><sup><italic>N</italic></sup> and <italic>S</italic>=(<italic>S</italic><sub><italic>j</italic></sub>)<sub>1</sub><sup><italic>M</italic></sup> (e.g. an antisense RNA and its target or an mRNA and its sRNA regulator) with <italic>N</italic> and <italic>M</italic> vertices, we label the vertices such that <italic>R</italic><sub>1</sub> is the 5&#x02032; end of <italic>R</italic> and <italic>S</italic><sub>1</sub> denotes the 3&#x02032; end of <italic>S</italic>. The arcs of <italic>R</italic> and <italic>S</italic> then represent the respective, intramolecular base pairs. An arc is called <italic>exterior</italic> if it is of the form <italic>R</italic><sub><italic>i</italic></sub><italic>S</italic><sub><italic>j</italic></sub> and <italic>interior</italic>, otherwise.</p><p>Next, we formally define joint structures (Alkan <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2006</xref>; Chitsaz <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2009b</xref>; Huang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2009</xref>; Pervouchine, <xref ref-type="bibr" rid="B27">2004</xref>). A <italic>joint structure</italic>, <italic>J</italic>(<italic>R</italic>, <italic>S</italic>, <italic>I</italic>), see <xref ref-type="fig" rid="F2">Fig. 2</xref>B, is a graph such that
<list list-type="order"><list-item><p><italic>R</italic>, <italic>S</italic> are secondary structures (each nucleotide being paired with at most one other nucleotide via hydrogen bonds, without internal pseudoknots);</p></list-item><list-item><p><italic>I</italic> is a set of exterior arcs without external pseudoknots, i.e. if <italic>R</italic><sub><italic>i</italic><sub>1</sub></sub> <italic>S</italic><sub><italic>j</italic><sub>1</sub></sub>, <italic>R</italic><sub><italic>i</italic><sub>2</sub></sub> <italic>S</italic><sub><italic>j</italic><sub>2</sub></sub> &#x02208; <italic>I</italic> then <italic>i</italic><sub>1</sub> &#x0003c; <italic>i</italic><sub>2</sub> implies <italic>j</italic><sub>1</sub> &#x0003c; <italic>j</italic><sub>2</sub>;</p></list-item><list-item><p><italic>J</italic>(<italic>R</italic>, <italic>S</italic>, <italic>I</italic>) contains no &#x02018;zig-zags&#x02019;, see <xref ref-type="fig" rid="F2">Fig. 2</xref>A;</p></list-item></list>
where a zig-zag is defined as follows: suppose there is an exterior arc <italic>R</italic><sub><italic>a</italic></sub><italic>S</italic><sub><italic>b</italic></sub> with <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub> and <italic>S</italic><sub><italic>i</italic>&#x02032;</sub> <italic>S</italic><sub><italic>j</italic>&#x02032;</sub>, where <italic>i</italic> &#x0003c; <italic>a</italic> &#x0003c; <italic>j</italic> and <italic>i</italic>&#x02032; &#x0003c; <italic>b</italic> &#x0003c; <italic>j</italic>&#x02032;. Then <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub> is <italic>subsumed</italic> in <italic>S</italic><sub><italic>i</italic>&#x02032;</sub> <italic>S</italic><sub><italic>j</italic>&#x02032;</sub>, if for any <italic>R</italic><sub><italic>k</italic></sub> <italic>S</italic><sub><italic>k</italic>&#x02032;</sub> &#x02208; <italic>I</italic>, <italic>i</italic> &#x0003c; <italic>k</italic> &#x0003c; <italic>j</italic> implies <italic>i</italic>&#x02032; &#x0003c; <italic>k</italic>&#x02032; &#x0003c; <italic>j</italic>&#x02032;. A <italic>zigzag</italic>, is a subgraph containing two dependent interior arcs <italic>R</italic><sub><italic>i</italic><sub>1</sub></sub> <italic>R</italic><sub><italic>j</italic><sub>1</sub></sub> and <italic>S</italic><sub><italic>i</italic><sub>2</sub></sub> <italic>S</italic><sub><italic>j</italic><sub>2</sub></sub> neither one subsuming the other (<xref ref-type="fig" rid="F2">Fig. 2</xref>). Dependence here means that there exists at least one exterior arc <italic>R</italic><sub><italic>h</italic></sub><italic>S</italic><sub>&#x02113;</sub> such that <italic>i</italic><sub>1</sub> &#x0003c; <italic>h</italic> &#x0003c; <italic>j</italic><sub>1</sub> and <italic>i</italic><sub>2</sub> &#x0003c; &#x02113; &#x0003c; <italic>j</italic><sub>2</sub>.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>(<bold>A</bold>) A zigzag, generated by <italic>R</italic><sub>2</sub><italic>S</italic><sub>1</sub>, <italic>R</italic><sub>3</sub><italic>S</italic><sub>3</sub> and <italic>R</italic><sub>5</sub><italic>S</italic><sub>4</sub>. (<bold>B</bold>) We partition the joint structure <italic>J</italic><sub>1,24;1,23</sub> in segments and tight structures.</p></caption><graphic xlink:href="btp635f2"/></fig></p><p>The (<italic>induced</italic>) <italic>subgraph</italic> of <italic>G</italic> induced by <italic>V</italic> has vertex set <italic>V</italic> and contains all <italic>G</italic>-edges having both incident vertices in <italic>V</italic>. The subgraph of a joint structure <italic>J</italic>(<italic>R</italic>, <italic>S</italic>, <italic>I</italic>) induced by a pair of subsequences (<italic>R</italic><sub><italic>i</italic></sub>, <italic>R</italic><sub><italic>i</italic>+1</sub>,&#x02026;, <italic>R</italic><sub><italic>j</italic></sub>) and (<italic>S</italic><sub><italic>h</italic></sub>, <italic>S</italic><sub><italic>h</italic>+1</sub>,&#x02026;, <italic>S</italic><sub>&#x02113;</sub>) is denoted by <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>. In particular, <italic>J</italic>(<italic>R</italic>, <italic>S</italic>, <italic>I</italic>)=<italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub> and <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> &#x02282; <italic>J</italic><sub><italic>a</italic>,<italic>b</italic>;<italic>c</italic>,<italic>d</italic></sub> if and only if <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is a subgraph of <italic>J</italic><sub><italic>a</italic>,<italic>b</italic>;<italic>c</italic>,<italic>d</italic></sub> induced by (<italic>R</italic><sub><italic>i</italic></sub>,&#x02026;, <italic>R</italic><sub><italic>j</italic></sub>) and (<italic>S</italic><sub><italic>h</italic></sub>,&#x02026;, <italic>S</italic><sub>&#x02113;</sub>). In particular, we use <italic>S</italic>[<italic>i</italic>, <italic>j</italic>] to denote the subgraph of the pre-structure <italic>G</italic>(<italic>R</italic>, <italic>S</italic>, <italic>I</italic>) induced by (<italic>S</italic><sub><italic>i</italic></sub>, <italic>S</italic><sub><italic>i</italic>+1</sub>,&#x02026;, <italic>S</italic><sub><italic>j</italic></sub>), where <italic>S</italic>[<italic>i</italic>, <italic>i</italic>]=<italic>S</italic><sub><italic>i</italic></sub> and <italic>S</italic>[<italic>i</italic>, <italic>i</italic> &#x02212; 1]=&#x02205;.</p><p>Given a joint structure, <italic>J</italic><sub><italic>a</italic>,<italic>b</italic>;<italic>c</italic>,<italic>d</italic></sub>, a tight structure (TS), <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, (Huang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2009</xref>) is a specific subgraph of <italic>J</italic><sub><italic>a</italic>,<italic>b</italic>;<italic>c</italic>,<italic>d</italic></sub>. A TS contains a rightmost exterior arc whose <italic>J</italic><sub><italic>a</italic>,<italic>b</italic>;<italic>c</italic>,<italic>d</italic></sub>-ancestors (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link> for more details) with maximal length give rise to one of the four types of joint structures illustrated in <xref ref-type="fig" rid="F3">Fig. 3</xref>. Intuitively, a TS is obtained as follows: given an exterior arc, &#x003b1;, consider its ancestors of maximal length. If there is none, then TS equals &#x003b1;. If there is (at least) one, &#x003b2;, then the TS is determined by the maximal ancestor of the leftmost exterior arc descending from &#x003b2; or its endpoint if there is none.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>The four basic types of TS. (<bold>A</bold>) &#x025cb; : {<italic>R</italic><sub><italic>i</italic></sub><italic>S</italic><sub><italic>h</italic></sub>} = <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> and <italic>i</italic> = <italic>j</italic>, <italic>h</italic> = &#x02113;; (<bold>B</bold>) &#x025bd; : <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub> &#x02208; <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> and <italic>S</italic><sub><italic>h</italic></sub><italic>S</italic><sub>&#x02113;</sub> &#x02209; <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>; (<bold>C</bold>) &#x025a1; : {<italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub>, <italic>S</italic><sub><italic>h</italic></sub><italic>S</italic><sub>&#x02113;</sub>} &#x02208; <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>; (<bold>D</bold>) &#x025b3; : <italic>S</italic><sub><italic>h</italic></sub><italic>S</italic><sub>&#x02113;</sub> &#x02208; <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> and <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub> &#x02209; <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>.</p></caption><graphic xlink:href="btp635f3"/></fig></p><p>In the following, a TS is denoted by <italic>J</italic><sup><italic>T</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>. If its type is known, then <italic>T</italic> can be replaced by its type &#x02208; {&#x025cb;, &#x025bd;, &#x025a1;, &#x025b3;}, see <xref ref-type="fig" rid="F3">Fig. 3</xref>. For instance, we use <italic>J</italic><sup>&#x025a1;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> to denote a TS of type&#x02003;&#x025a1;.</p></sec><sec id="SEC2.2"><title>2.2 The hybrid grammar</title><p>A <italic>hybrid</italic> structure, <italic>J</italic><sup>Hy</sup><sub><italic>i</italic><sub>1</sub>,<italic>i</italic><sub>&#x02113;</sub>;<italic>j</italic><sub>1</sub>,<italic>j</italic><sub>&#x02113;</sub></sub>, is a maximal sequence of intermolecular interior loops consisting of exterior arcs (<italic>R</italic><sub><italic>i</italic><sub>1</sub></sub> <italic>S</italic><sub><italic>j</italic><sub>1</sub></sub>,&#x02026;, <italic>R</italic><sub><italic>i</italic><sub>&#x02113;</sub></sub> <italic>S</italic><sub><italic>j</italic><sub>&#x02113;</sub></sub>) where <italic>R</italic><sub><italic>i</italic><sub><italic>h</italic></sub></sub> <italic>S</italic><sub><italic>j</italic><sub><italic>h</italic></sub></sub> is nested within <italic>R</italic><sub><italic>i</italic><sub><italic>h</italic>+1</sub></sub> <italic>S</italic><sub><italic>j</italic><sub><italic>h</italic>+1</sub></sub> and where the internal segments <italic>R</italic>[<italic>i</italic><sub><italic>h</italic></sub> + 1, <italic>i</italic><sub><italic>h</italic>+1</sub> &#x02212; 1] and <italic>S</italic>[<italic>j</italic><sub><italic>h</italic></sub> + 1, <italic>j</italic><sub><italic>h</italic>+1</sub> &#x02212; 1] consist of single-stranded nucleotides only. That is, a hybrid is the maximal unbranched stem&#x02013;loop formed by external arcs. Each hybrid thus forms a distinctive region of interaction between the two RNAs. Note that we can interpret interactions admitted by <monospace>intaRNA</monospace>/<monospace>RNAup</monospace> (Busch <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>; M&#x000fc;ckstein <italic>et al.</italic>, <xref ref-type="bibr" rid="B25">2008</xref>) as joint structures with at most one hybrid.</p><p>In the following, we redesign the grammar outlined by Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>) so that it explicitly makes use of hybrids. An efficient solution of the partition function problem for RIP requires an unambiguous context-free grammar with the constraint that the number of break points, i.e. the number of non-terminals in each individual production, is as small as possible. This is achieved by introducing several specific types of joint structures that are described in detail in the following. We call a joint <italic>right-tight structure</italic> (RTS), <italic>J</italic><sup><italic>RT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub> in <italic>J</italic><sub><italic>i</italic><sub>1</sub>,<italic>j</italic><sub>1</sub>;<italic>r</italic><sub>1</sub>,<italic>s</italic><sub>1</sub></sub>, if its rightmost block is a <italic>J</italic><sub><italic>i</italic><sub>1</sub>,<italic>j</italic><sub>1</sub>;<italic>r</italic><sub>1</sub>,<italic>s</italic><sub>1</sub></sub>-TS and <italic>double-tight</italic> structure (DTS), <italic>J</italic><sup><italic>DT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub> in <italic>J</italic><sub><italic>i</italic><sub>1</sub>,<italic>j</italic><sub>1</sub>;<italic>r</italic><sub>1</sub>,<italic>s</italic><sub>1</sub></sub>, if both of its leftmost and rightmost blocks are <italic>J</italic><sub><italic>i</italic><sub>1</sub>,<italic>j</italic><sub>1</sub>;<italic>r</italic><sub>1</sub>,<italic>s</italic><sub>1</sub></sub>-TS's. We remark that this definition is a bit different from the notion of the DTS defined in Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>). In particular, we consider single interaction arcs as particular DTS. Adopting the point of view of Algebraic Dynamic Programming (Giegerich and Meyer, <xref ref-type="bibr" rid="B16">2002</xref>), we regard each decomposition rule as a production in a suitable grammar. <xref ref-type="fig" rid="F4">Fig. 4</xref> summarizes the three basic steps of the hybrid grammar: (I) &#x0201c;interior arc-removal&#x0201d; to reduce TS. The scheme is complemented by the usual loop decomposition of secondary structures, and (II) &#x0201c;block-decomposition&#x0201d; to split a joint structure into two smaller blocks.
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>Illustration of the reduction of arbitrary joint structures and of right-tight structures, Procedure (a), and of tight structures, Procedure (b). In the bottom row the symbols for the 10 distinct types of structural components are listed: <bold>A</bold>, <bold>B</bold> maximal secondary structure segments <italic>R</italic>[<italic>i</italic>, <italic>j</italic>], <italic>S</italic>[<italic>r</italic>, <italic>s</italic>]; <bold>C</bold> arbitrary joint structure <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub>; <bold>D</bold> right-tight structures <italic>J</italic><sup><italic>RT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub>; <bold>E</bold> double-tight structure <italic>J</italic><sup><italic>DT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub>; <bold>F</bold> tight structure of type &#x025bd;, &#x025b3; or &#x025a1;; <bold>G</bold> type &#x025a1; tight structure <italic>J</italic><sup>&#x025a1;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub>; <bold>H</bold> type &#x025bd; tight structure <italic>J</italic><sup>&#x025bd;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub>; <bold>J</bold> type &#x025b3; tight structure <italic>J</italic><sup>&#x025b3;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub>; <bold>K</bold> hybrid structure <italic>J</italic><sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>; <bold>L</bold> substructure of a hybrid <italic>J</italic><sup><monospace>h</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> such that <italic>R</italic><sub><italic>i</italic></sub><italic>S</italic><sub><italic>j</italic></sub> and <italic>R</italic><sub><italic>h</italic></sub><italic>S</italic><sub>&#x02113;</sub> are exterior arcs and <italic>J</italic><sup><monospace>h</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> itself is not a hybrid since it is not maximal; <bold>M</bold> isolated segment <italic>R</italic>[<italic>i</italic>, <italic>j</italic>] or <italic>S</italic>[<italic>h</italic>, &#x02113;].</p></caption><graphic xlink:href="btp635f4"/></fig></p><p>The grammar in <xref ref-type="fig" rid="F4">Fig. 4</xref> corresponds to the decomposition (parsing) of a joint structure into interior arcs and hybrids. <xref ref-type="fig" rid="F5">Fig. 5</xref>A shows the corresponding parse tree. The full details of the decomposition procedures are described in <xref ref-type="sec" rid="SEC2">Section 2</xref> of the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link>, where we show that for each joint structure <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub>, we indeed obtain a unique decomposition tree (parse tree), denoted by <italic>T</italic><sub><italic>J</italic><sub>1</sub>,<italic>N</italic>;1,<italic>M</italic></sub>. More precisely, <italic>T</italic><sub><italic>J</italic><sub>1</sub>,<italic>N</italic>;1,<italic>M</italic></sub> has root <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub> and all other vertices correspond to a specific substructure of <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub> obtained by the successive application of the decomposition steps of <xref ref-type="fig" rid="F4">Fig. 4</xref> and the loop decomposition of the secondary structures. Thus, the hybrid grammar is unambiguous. The two panels of <xref ref-type="fig" rid="F5">Fig. 5</xref> contrast the grammars of <monospace>rip1</monospace> (Huang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2009</xref>) and the hybrid grammar of <monospace>rip2</monospace> introduced here. In <monospace>rip1</monospace>, hybrids were immediately decomposed into individual external base pairs and their associated interior loops, so that individual hybrids were not tractable in a straightforward manner.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>Different grammars lead to different (parse) trees. We show the parse tree <italic>T</italic><sub><italic>J</italic><sub>1,11;1,11</sub></sub> for the same joint structure <italic>J</italic><sub>1,11;1,11</sub> according to the grammars of <monospace>rip2</monospace> (<bold>A</bold>) and <monospace>rip1</monospace> (<bold>B</bold>), respectively.</p></caption><graphic xlink:href="btp635f5"/></fig></p><p>Let us now have a closer look at the energy evaluation of <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>. Each decomposition step in <xref ref-type="fig" rid="F4">Fig. 4</xref> results in substructures whose energies are assumed to contribute additively and generalized loops that can be evaluated directly. There are the following two basic scenarios:</p><p>(I) Interior Arc removal: the first type of decomposition is derived from the decomposition of TS of Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>). Most of the decomposition operations in Procedure (b) displayed in <xref ref-type="fig" rid="F4">Fig. 4</xref> can be viewed as the &#x0201c;removal&#x0201d; of an arc (corresponding to the closing pair of a loop in secondary structure folding) followed by decomposition. Both, loop type as well as the subsequent decomposition steps depend on the newly exposed structural elements. Following the approach of Zuker and Sankoff (<xref ref-type="bibr" rid="B37">1984</xref>) for secondary structures, we treat the loop-decomposition problem by introducing additional matrices. Without loss of generality, we can assume that we open an interior base pair <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub>.</p><p>The set of base pairs on <italic>R</italic>[<italic>i</italic>, <italic>j</italic>] consists of all interior pairs <italic>R</italic><sub><italic>p</italic></sub><italic>R</italic><sub><italic>q</italic></sub> with <italic>i</italic> &#x02264;<italic>p</italic> &#x0003c;<italic>q</italic> &#x02264;<italic>j</italic> and all exterior pairs <italic>R</italic><sub><italic>p</italic></sub> <italic>S</italic><sub><italic>h</italic></sub> with <italic>i</italic> &#x02264; <italic>p</italic> &#x02264; <italic>j</italic>. An interior arc is <italic>exposed</italic> on <italic>R</italic>[<italic>i</italic> + 1, <italic>j</italic> &#x02212; 1] if and only if it is not enclosed by any interior arc in <italic>R</italic>[<italic>i</italic>, <italic>j</italic>]. An exterior arc is <italic>exposed</italic> on <italic>R</italic>[<italic>i</italic> + 1, <italic>j</italic> &#x02212; 1] if and only if it is not a descendant of any interior arc in <italic>R</italic>[<italic>i</italic> + 1, <italic>j</italic> &#x02212; 1]. Given <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub>, the arcs exposed on <italic>R</italic>[<italic>i</italic> + 1, <italic>j</italic> &#x02212; 1] correspond to the base pairs <italic>immediately interior</italic> of <italic>R</italic><sub><italic>i</italic></sub><italic>R</italic><sub><italic>j</italic></sub>. Let us write <inline-formula><inline-graphic xlink:href="btp635i1.jpg"/></inline-formula> for this set of &#x02018;exposed base pairs&#x02019; and its subsets of interior and exterior arcs. As in secondary structure folding, the loop type is determined by <italic>E</italic><sub><italic>R</italic>[<italic>i</italic>,<italic>j</italic>]</sub>&#x02254;<italic>E</italic><sub><italic>R</italic></sub> as follows: <italic>E</italic><sub><italic>R</italic></sub> = &#x02205;, hairpin loop; <italic>E</italic><sub><italic>R</italic></sub> = <italic>E</italic><sup><italic>i</italic></sup><sub><italic>R</italic></sub> and |<italic>E</italic><sub><italic>R</italic></sub>| = 1, interior loop (including bulge and stacks); <italic>E</italic><sub><italic>R</italic></sub> = <italic>E</italic><sup><italic>i</italic></sup><sub><italic>R</italic></sub>, |<italic>E</italic><sub><italic>R</italic></sub>|&#x02265;2, multi-branch loop; <italic>E</italic><sub><italic>R</italic></sub> = <italic>E</italic><sup><italic>e</italic></sup><sub><italic>R</italic></sub>, kissing-hairpin loop; |<italic>E</italic><sup><italic>i</italic></sup><sub><italic>R</italic></sub>|, |<italic>E</italic><sup><italic>e</italic></sup><sub><italic>R</italic></sub>| &#x02265; 1, general kissing loop.</p><p>This picture needs to be refined even further since the arc removal is coupled with further decomposition of the interval <italic>R</italic>[<italic>i</italic> + 1, <italic>j</italic> &#x02212; 1]. This prompts us to distinguish TS and DTS with different classes of exposed base pairs on one or both strands. It will be convenient, furthermore, to include information on the type of loop in which it was found.</p><p>A TS <italic>J</italic><sup>&#x025bd;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is of type <monospace>E</monospace>, if <italic>S</italic>[<italic>h</italic>, &#x02113;] is not enclosed in any base pair (<italic>J</italic><sup>&#x025bd;,<monospace>E</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>). Suppose <italic>J</italic><sup>&#x025bd;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is located immediately interior to the closing pair <italic>S</italic><sub><italic>p</italic></sub><italic>S</italic><sub><italic>q</italic></sub> (<italic>p</italic> &#x0003c; <italic>h</italic> &#x0003c; &#x02113; &#x0003c; <italic>q</italic>). If the loop closed by <italic>S</italic><sub><italic>p</italic></sub><italic>S</italic><sub><italic>q</italic></sub> is a multi-loop, then <italic>J</italic><sup>&#x025bd;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is of type <monospace>M</monospace> (J<sup>&#x025bd;,<monospace>M</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>). If <italic>S</italic><sub><italic>p</italic></sub><italic>S</italic><sub><italic>q</italic></sub> is contained in a kissing loop, we distinguish the types <monospace>F</monospace> and <monospace>K</monospace>, depending on whether or not <italic>E</italic><sup><italic>e</italic></sup><sub><italic>S</italic>[<italic>h</italic>,&#x02113;]</sub> = &#x02205;.</p><p>Analogously, there are in total four types of a hybrid <italic>J</italic><sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, i.e. {<italic>J</italic><sup><monospace>Hy</monospace>,<monospace>EE</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>EK</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>KE</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>KK</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>}.</p><p>(II) Block decomposition: the second type of decomposition is the splitting of joint structures into &#x02018;blocks&#x02019;. Here, the hybrid grammar differs from the grammar of Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>) in two ways. First, we use the hybrid as a new block of the grammar, decomposing a hybrid by removing its exterior arcs in parallel simultaneously starting from the right. Second, we split a joint structure into blocks via alternating decompositions of RTS and DTS as shown in the Procedure (a) of <xref ref-type="fig" rid="F4">Fig. 4</xref>.</p><p>In order to guarantee the maximality hybrids, we observe that the RTS's <italic>J</italic><sup><italic>RT</italic>,<italic>KK</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><italic>RT</italic>,<italic>KE</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><italic>RT</italic>,<italic>EK</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> and <italic>J</italic><sup><italic>RT</italic>,<italic>EE</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> can appear in two scenarios, depending on whether or not there exists an exterior arc <italic>R</italic><sub><italic>i</italic><sub>1</sub></sub> <italic>S</italic><sub><italic>h</italic><sub>1</sub></sub> such that <italic>R</italic>[<italic>i</italic>, <italic>i</italic><sub>1</sub> &#x02212; 1] and <italic>S</italic>[<italic>h</italic>, <italic>h</italic><sub>1</sub> &#x02212; 1] are isolated segments. In case such an exterior arc exists, we say the RTS is of type (<monospace>B</monospace>) or (<monospace>A</monospace>), otherwise. Similarly, a DTS, <italic>J</italic><sup><italic>DT</italic>,<italic>KK</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><italic>DT</italic>,<italic>KE</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><italic>DT</italic>,<italic>EK</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> or <italic>J</italic><sup><italic>DT</italic>,<italic>EE</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is of type (<monospace>B</monospace>) or (<monospace>A</monospace>) depending on whether <italic>R</italic><sub><italic>i</italic></sub><italic>S</italic><sub><italic>h</italic></sub> is an exterior arc. In <xref ref-type="fig" rid="F6">Fig. 6</xref>A, we display the decomposition of <italic>J</italic><sup><italic>DT</italic>,<monospace>KKB</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> into hybrids and RTS of type (<monospace>A</monospace>) and in <xref ref-type="fig" rid="F6">Fig. 6</xref>B, we display the decomposition of <italic>J</italic><sup><italic>RT</italic>,<monospace>KKA</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> into secondary structure segments and DTS accordingly.
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>Decomposition of <italic>J</italic><sup><italic>DT</italic>,<monospace>KKB</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> (l.h.s.) and <italic>J</italic><sup><italic>RT</italic>,<monospace>KKA</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> (r.hs.).</p></caption><graphic xlink:href="btp635f6"/></fig>
<fig id="F7" position="float"><label>Fig. 7.</label><caption><p>Hybrid probability: the maximality of hybrids implies that&#x02014;although the intervals [<italic>h</italic><sub>1</sub>, &#x02113;<sub>1</sub>] and [<italic>h</italic><sub>2</sub>, &#x02113;<sub>2</sub>] overlap&#x02014;they belong to two distinct hybrids (gray).</p></caption><graphic xlink:href="btp635f7"/></fig></p><p>Suppose <italic>J</italic><sup><italic>DT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,&#x02113;</sub> is a DTS contained in a kissing loop, that is, we have either <italic>E</italic><sup><italic>e</italic></sup><sub><italic>R</italic>[<italic>i</italic>,<italic>j</italic>]</sub> &#x02260; &#x02205; or <italic>E</italic><sup><italic>e</italic></sup><sub><italic>S</italic>[<italic>h</italic>,&#x02113;]</sub> &#x02260; &#x02205;. Without loss of generality, we may assume <italic>E</italic><sup><italic>e</italic></sup><sub><italic>R</italic>[<italic>i</italic>,<italic>j</italic>]</sub> &#x02260; &#x02205;. Then, at least one of the two &#x02018;blocks&#x02019; contains at least an exterior arc belonging to <italic>E</italic><sup><italic>e</italic></sup><sub><italic>R</italic>[<italic>i</italic>,<italic>j</italic>]</sub> labeled by <monospace>K</monospace> or <monospace>F</monospace>, otherwise, see <xref ref-type="fig" rid="F6">Fig. 6</xref>A.</p></sec><sec id="SEC2.3"><title>2.3 Forward recursions</title><p>The computation of the partition function proceeds &#x02018;from the inside to the outside&#x02019;, see Equation (<xref ref-type="disp-formula" rid="M3">3</xref>). The recursions are initialized with the energies of individual external base pairs and empty secondary structures on subsequences of length up to 4. In order to differentiate multi- and kissing-loop contributions, we introduce the partition functions <italic>Q</italic><sup><monospace>m</monospace></sup><sub><italic>i</italic>,<italic>j</italic></sub> and <italic>Q</italic><sup><monospace>k</monospace></sup><sub><italic>i</italic>,<italic>j</italic></sub>. Here, <italic>Q</italic><sup><monospace>m</monospace></sup><sub><italic>i</italic>,<italic>j</italic></sub> denotes the partition function of secondary structures on <italic>R</italic>[<italic>i</italic>, <italic>j</italic>] or <italic>S</italic>[<italic>i</italic>, <italic>j</italic>] having at least one arc contained in a multi-loop. Similarly, <italic>Q</italic><sup><monospace>k</monospace></sup><sub><italic>i</italic>,<italic>j</italic></sub> denotes the partition function of secondary structures on <italic>R</italic>[<italic>i</italic>, <italic>j</italic>] or <italic>S</italic>[<italic>i</italic>, <italic>j</italic>] in which at least one arc is contained in a kissing loop. Let &#x1d541;<sup>&#x003be;,<italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> be the set of substructures <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> &#x02282; <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub>, induced from some joint structure <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub>, such that <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> appears in <italic>T</italic><sub><italic>J</italic><sub>1</sub>,<italic>N</italic>;1,<italic>M</italic></sub> as an interaction structure of type &#x003be; &#x02208; {<italic>DT</italic>, <italic>RT</italic>, &#x025bd;, &#x025b3;, &#x025a1;, &#x025cb;} with loop-subtypes <italic>Y</italic><sub>1</sub>,<italic>Y</italic><sub>2</sub> &#x02208; {<monospace>M</monospace>, <monospace>K</monospace>, <monospace>F</monospace>} on the subintervals <italic>R</italic>[<italic>i</italic>, <italic>j</italic>] and <italic>S</italic>[<italic>h</italic>, &#x02113;], <italic>Y</italic><sub>3</sub> &#x02208; {<monospace>A</monospace>, <monospace>B</monospace>}. Let <italic>Q</italic><sup>&#x003be;,<italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> denote the partition function of the set &#x1d541;<sup>&#x003be;,<italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>. All recursions for <italic>Q</italic><sup>&#x003be;,<italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> represent a reformulation of the hybrid grammar specified in <xref ref-type="fig" rid="F4">Fig. 4</xref>.</p><p>For instance, the recursion for <italic>Q</italic><sup><italic>DT</italic>,<monospace>KKB</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> displayed in <xref ref-type="fig" rid="F6">Fig. 6</xref>A is given by:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btp635m1"/></disp-formula>
where the corresponding recursion for <italic>Q</italic><sup><monospace>Hy</monospace>,<monospace>KK</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btp635m2"/></disp-formula>
Analogously, the recursions for <italic>Q</italic><sup><monospace>Hy</monospace>,<monospace>EE</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>Q</italic><sup><monospace>Hy</monospace>,<monospace>EK</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> and <italic>Q</italic><sup><monospace>Hy</monospace>,<monospace>KE</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> read:
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btp635m3"/></disp-formula></p></sec><sec id="SEC2.4"><title>2.4 Hybrid probabilities</title><p>Since the probabilities of individual base pairs are not independent, it is not possible to compute the probabilities for particular hybrids directly from them. Hybrid probabilities thus cannot be obtained in a simple way from the backward recursions described by Huang <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2009</xref>).</p><p>Given two RNA sequences, our notion of probability is based on the ensemble of all possible joint interaction structures. Let <italic>Q</italic><sup><italic>I</italic></sup> denote the partition function of all these joint structures that can formed by two input RNA sequences. The probability of a fixed joint structure <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub> is given by
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btp635m4"/></disp-formula></p><p>In difference to the computation of the hybrid-partition function &#x02018;from the inside to the outside&#x02019; (IO), the computation of probabilities of specific substructures is obtained &#x02018;from the outside to the inside&#x02019;. The same principle applies to the computation of base pairing computation of base pairing probabilities of secondary structures (McCaskill, <xref ref-type="bibr" rid="B21">1990</xref>) and joint structures (Huang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2009</xref>).</p><p>Let <italic>J</italic> = <italic>J</italic><sub>1,<italic>N</italic>;1,<italic>M</italic></sub>, with associated decomposition tree <italic>T</italic>(<italic>J</italic>) and let &#x0039b;<sub><italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub></sub> = {<italic>J</italic> &#x02223; <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> &#x02208; <italic>T</italic>(<italic>J</italic>)} denote the set of all joint structures <italic>J</italic> such that <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is contained in the decomposition tree <italic>T</italic>(<italic>J</italic>). Then we have, by construction,
<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btp635m5"/></disp-formula></p><p>Following the (OI)-paradigm, the probability of a parent structure, &#x02119;<sub>&#x003b8;<sub><italic>s</italic></sub></sub>, is computed prior to the calculation of &#x02119;<sub><italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub></sub>. The conditional probability &#x02119;<sub><italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;|&#x003b8;<sub><italic>s</italic></sub></sub></sub> equals <italic>Q</italic><sub>&#x003b8;<sub><italic>s</italic></sub></sub>(<italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>)/<italic>Q</italic>(&#x003b8;<sub><italic>s</italic></sub>), where <italic>Q</italic>(&#x003b8;<sub><italic>s</italic></sub>) is the partition function of &#x003b8;<sub><italic>s</italic></sub>, and <italic>Q</italic><sub>&#x003b8;<sub><italic>s</italic></sub></sub>(<italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>) the partition function of all those &#x003b8;<sub><italic>s</italic></sub>, that have in addition <italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> as a child in their parse trees. Consequently, &#x02119;<sub><italic>J</italic><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub></sub> can inductively be computed by summing over all probabilities &#x02119;<sub>&#x003b8;<sub><italic>s</italic></sub></sub>, i.e.
<disp-formula id="M6"><label>(6)</label><graphic xlink:href="btp635m6"/></disp-formula></p><p>Let &#x02119;<sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> denote the probability of the set of substructures <italic>J</italic> such that the specific hybrid substructure, <italic>J</italic><sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, appears in the decomposition tree <italic>T</italic>(<italic>J</italic>), i.e. <italic>J</italic><sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> &#x02208; <italic>T</italic>(<italic>J</italic>). Since each joint structure <italic>J</italic><sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> is either one of the four types <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>EE</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>EK</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>KE</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub> or <italic>J</italic><sup><monospace>Hy</monospace>,<monospace>KK</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic>,&#x02113;</sub>, we arrive at
<disp-formula id="M7"><label>(7)</label><graphic xlink:href="btp635m7"/></disp-formula></p><p>We remark that, by construction, for [<italic>h</italic><sub>1</sub>, &#x02113;<sub>1</sub>]&#x02260;[<italic>h</italic><sub>2</sub>, &#x02113;<sub>2</sub>], the hybrid probabilities &#x02119;<sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic><sub>1</sub>,&#x02113;<sub>1</sub></sub> and &#x02119;<sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic><sub>2</sub>,&#x02113;<sub>2</sub></sub> quantify disjoint classes of joint structures. This is a consequence of the maximality of hybrids, which implies that, for fixed interval [<italic>i</italic>, <italic>j</italic>], each [<italic>h</italic><sub>1</sub>, &#x02113;<sub>1</sub>] corresponds to a unique hybrid <italic>J</italic><sup><monospace>Hy</monospace></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>h</italic><sub>1</sub>,&#x02113;<sub>1</sub></sub>. Based on the notion of hybrid probability, we can introduce
<disp-formula id="M8"><label>(8)</label><graphic xlink:href="btp635m8"/></disp-formula>
which is, according to the above, the probability of the target site [<italic>i</italic>, <italic>j</italic>] and furthermore
<disp-formula id="M9"><label>(9)</label><graphic xlink:href="btp635m9"/></disp-formula>
measuring, for each base <italic>i</italic> in <italic>R</italic> the probability that <italic>i</italic> is contained in a hybrid. A particulary instructive observable is the interaction base pairing matrix, given by
<disp-formula id="M10"><label>(10)</label><graphic xlink:href="btp635m10"/></disp-formula></p><p>Clearly, &#x003c0;<sub><italic>i</italic>,<italic>k</italic></sub> measures the probability that a pair of nucleotides (<italic>i</italic>, <italic>k</italic>), located on different strands, is contained in an interaction region. In contrast with the base pairing probabilities, large values of &#x003c0;<sub><italic>i</italic>,<italic>k</italic></sub> do not imply that <italic>i</italic> and <italic>k</italic> actually form an exterior base pair. Instead, it highlights regions of intermolecular interactions.</p></sec><sec id="SEC2.5"><title>2.5 Boltzmann sampling</title><p>A dynamic programming scheme for the computation of a partition function implies a corresponding stochastic backtracing procedure that can be used to sample from the associated distribution (Tacker <italic>et al.</italic>, <xref ref-type="bibr" rid="B32">1996</xref>). The usefulness of this approach for RNA secondary structures is discussed by Ding and Lawrence (<xref ref-type="bibr" rid="B12">2003</xref>). The same ideas can of course also produce representative samples from the Boltzmann equilibrium distribution of RNA interaction structures (<xref ref-type="fig" rid="F8">Fig. 8</xref>).
<fig id="F8" position="float"><label>Fig. 8.</label><caption><p>Stochastic backtracing algorithm: elements of stack &#x1d49c; are successively decomposed according to the hybrid-grammar. The resulting arcs and unpaired vertices are stored in the list &#x02112; which, once &#x1d49c; is empty, eventually contains the Boltzmann-sampled interaction structure.</p></caption><graphic xlink:href="btp635f8"/></fig></p><p>The basic data structure of the algorithm is a stack &#x1d49c; that stores tuples of the form {(<italic>i</italic>, <italic>j</italic>; <italic>h</italic>, &#x02113;; &#x003be;)} describing a pair of intervals [<italic>i</italic>, <italic>j</italic>] in <italic>R</italic> and [<italic>h</italic>, &#x02113;] in <italic>S</italic> and the type &#x003be; of the&#x02014;not further specified&#x02014;joint structure formed by the two intervals. The stack &#x1d49c;, initialized with (1, <italic>N</italic>; 1, <italic>M</italic>, ?) where &#x02018;?&#x02019; denotes the unspecified type, guides the backtracing which is complete as soon as &#x1d49c; is empty. A list &#x02112; is used to collect the interior and exterior arcs and unpaired bases generated by the decompositions and eventually define the sampled interaction structure. In the first step, (1, <italic>N</italic>; 1, <italic>M</italic>, ?) is decomposed according to the grammar in <xref ref-type="fig" rid="F4">Fig. 4</xref> into either (i) a pair of secondary structures, or (ii) a RTS (<italic>i</italic>, <italic>N</italic>; <italic>j</italic>, <italic>M</italic>; <italic>RT</italic><monospace>EE</monospace>) with probabilities derived as explained above. Depending on the stochastic choice, we push either (i) (1, <italic>N</italic>; 0, 0; <monospace>sec</monospace>) and (0, 0; 1, <italic>M</italic>; <monospace>sec</monospace>) or (ii) (1, <italic>i</italic> &#x02212; 1; 0, 0, <monospace>sec</monospace>), (0, 0; 1, <italic>j</italic> &#x02212; 1; <monospace>sec</monospace>) and (<italic>i</italic>, <italic>N</italic>; <italic>j</italic>, <italic>M</italic>; <italic>RT</italic><monospace>EE</monospace>) into the stack &#x1d49c;.</p><p>Given &#x1d49c; and &#x02112;, we can associate a probability by considering the decomposition of the particular type of joint structure. For instance, suppose we have extracted (<italic>i</italic>, <italic>j</italic>; <italic>h</italic>, &#x02113;, <italic>DT</italic><monospace>KKB</monospace>) from stack &#x1d49c;, see <xref ref-type="fig" rid="F6">Fig. 6</xref>. Then, the probabilities for continuing with one of the five decompositions displayed in <xref ref-type="fig" rid="F6">Fig. 6</xref>, for each position of the break points <italic>i</italic><sub>1</sub> &#x02208; [<italic>i</italic>, <italic>j</italic>] and <italic>h</italic><sub>1</sub> &#x02208; [<italic>h</italic>, &#x02113;], is given by
<disp-formula><graphic xlink:href="btp635um1"/></disp-formula>
One of these decompositions is accordingly sampled and the respective output is pushed back into stack &#x1d49c;. For instance, if &#x02119;<sup>1</sup><sub><italic>i</italic><sub>1</sub>,<italic>h</italic><sub>1</sub></sub> is selected, then we push (<italic>i</italic>, <italic>i</italic><sub>1</sub>; <italic>h</italic>, <italic>h</italic><sub>1</sub>; <monospace>HyKK</monospace>) and (<italic>i</italic><sub>1</sub> + 1, <italic>j</italic>; <italic>h</italic><sub>1</sub> + 1, &#x02113;; <italic>RT</italic><monospace>KF</monospace>) back into stack &#x1d49c;.</p></sec></sec><sec id="SEC3"><title>3 RESULTS AND CONCLUSIONS</title><p>We presented here a modified and improved unambiguous grammar for the RIP. Compared with <monospace>rip1</monospace> (Huang <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2009</xref>), it reduces the computational efforts, in particular the memory consumption, by about a third. In the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link>, we contrast <monospace>rip2</monospace> with <monospace>rip1</monospace> and show that hybrids (as opposed to TS, RTS or DTS) are uniquely suited for identifying the interaction regions of two RNA molecules. The complete set of recursions is compiled in <xref ref-type="sec" rid="SEC3">Section 3</xref> of the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link>. It comprises 9 4D-arrays <italic>Q</italic><sup>&#x025b3;,&#x025bd;,&#x025a1;</sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub> for TS of various types, 20 4D-arrays <italic>Q</italic><sup><italic>RT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub> for RTS and 20 4D-arrays <italic>Q</italic><sup><italic>DT</italic></sup><sub><italic>i</italic>,<italic>j</italic>;<italic>r</italic>,<italic>s</italic></sub> for DTS. The implementation has been complemented by a stochastic backtracing facility. <xref ref-type="fig" rid="F9">Fig. 9</xref> gives an example of the output produced by <monospace>rip2</monospace> (see also <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp635/DC1">Supplementary Material</ext-link>, <xref ref-type="fig" rid="F4">Fig. 4</xref>). Despite algorithmic improvements, <monospace>rip2</monospace> still requires quite substantial computational resources for practical applications. <monospace>rip2</monospace> is in practise limited to problem sizes of <inline-formula><inline-graphic xlink:href="btp635i2.jpg"/></inline-formula> on current hardware. While <monospace>rip2</monospace> is still not an efficient tool for large-scale routine applications, it is suitable for investigating the fine details of particular interactions. Future work will thus focus on controlled approximations with the aim of a drastic reduction of both: CPU and memory consumption.
<fig id="F9" position="float"><label>Fig. 9.</label><caption><p>Interaction of <italic>sodB</italic>&#x02013;<italic>RhyB</italic>. (<bold>A</bold>) Base-pairing probability matrix. The upper right triangle shows the probabilities obtained from the exact backwards recursion, the lower left triangle is the estimate from a sample of 10 000 structures obtained by stochastic backtracing, showing that the estimates converge quickly. (<bold>B</bold>) Comparison of the structure proposed in Geissmann and Touati (<xref ref-type="bibr" rid="B15">2004</xref>) and the <monospace>rip2</monospace> prediction. While the major stable hairpins agree and <monospace>rip2</monospace> correctly predicts the primary interaction region, <monospace>rip2</monospace> also identifies additional interaction regions that may stabilize the interaction. (<bold>C</bold>) Sampled joint structures (here the 20 most frequent ones) are represented as dot-bracket strings: () and [] represent pairs of interior and exterior arc, respectively, while dots indicate unpaired bases. | separates the two RNA sequences which are both written in 5<sup>&#x02032;</sup> &#x02192; 3<sup>&#x02032;</sup> direction.</p></caption><graphic xlink:href="btp635f9"/></fig></p><p>The major advantage of stochastic sampling is that it provides a generic and convenient means to estimate quantities that cannot be easily computed directly by backwards recursion (Ding and Lawrence, <xref ref-type="bibr" rid="B12">2003</xref>). Both, the <italic>ompA</italic>-<italic>MicA</italic> and <italic>sodB</italic>-<italic>RhyB</italic> complexes show a primary, highly likely, hybrid region and several additional less stable points of contact, see <xref ref-type="fig" rid="F10">Fig. 10</xref>. In these examples, it is of interest to investigate in detail how the putative interaction regions influence each other: is the binding cooperative so that the major hybrids in <xref ref-type="fig" rid="F10">Fig. 10</xref> are positively correlated, or do they constitute mutually exclusive contacts? Once a sufficiently large Boltzmann sample is obtained, we can easily compute, e.g. correlations &#x003c1;<sub><italic>PQ</italic></sub> between indicator variables <italic>P</italic> and <italic>Q</italic> that measure the existence of external base pairs in two different hybrids. <xref ref-type="fig" rid="F10">Fig. 10</xref>C provide examples, showing that there are strong correlations between hybridization regions. These multiple contacts can contribute substantially to the total interaction energy.
<fig id="F10" position="float"><label>Fig. 10.</label><caption><p>Interaction maps. The <italic>ompA</italic>&#x02013;<italic>MicA</italic> interaction (<bold>A</bold>) has a dominating interaction region that brings together the 3<sup>&#x02032;</sup> end of <italic>ompA</italic> and the 5<sup>&#x02032;</sup> terminus of <italic>MicA</italic>. The <italic>sodB</italic>&#x02013;<italic>RhyB</italic> interactions (<bold>B</bold>) has two clear hybridization regions in the middle of the molecules and a diffuse contact area at the 3<sup>&#x02032;</sup> end of <italic>sodB</italic>. The grayscale show the probabilities &#x003c0;<sub><italic>ik</italic></sub>. Tick marks indicate every 10th nucleotide. The correlations between the major binding regions can be computed easily from Boltzmann samples. The heatmaps show the correlation coefficients for the most probable interaction regions (indicated by numbers in the interaction maps). (<bold>C</bold>) For <italic>sodB</italic>&#x02013;<italic>RhyB</italic>, we observe fairly weak correlations, except for the cooperative interaction between contacts <monospace>3</monospace> and <monospace>4</monospace>. In case of <italic>ompA</italic>&#x02013;<italic>MicA</italic>, we observe strong negative correlations between conflicting hybridization regions.</p></caption><graphic xlink:href="btp635f10"/></fig></p></sec>
      <sec sec-type="supplementary-material">
         <title>Supplementary Material</title>
         <supplementary-material id="PMC_1" content-type="local-data">
            <caption>
               <title>[Supplementary Data]</title>
            </caption>
            <media mimetype="text" mime-subtype="html" xlink:href="btp635_index.html"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
                   xlink:href="btp635_1.pdf"/>
         </supplementary-material>
      </sec>
   </body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We want to thank Sven Findei&#x000df; for discussions. We are grateful to Sharon Selzo of the Modular and BICoC Benchmark Center, IBM and Kathy Tzeng of IBM Life Sciences Solutions Enablement. Their great support was vital for all computations presented here.</p><p><italic>Funding</italic>: 973 Project of the Ministry of Science and Technology; PCSIRT Project of the Ministry of Education; National Science Foundation of China (to C.M.R. and his lab); Deutsche Forschungsgemeinschaft under the auspices of SPP-1258 &#x02018;Small Regulatory RNAs in Prokaryotes&#x02019; (grant No. STA 850/7-1to P.F.S. and his lab); European Community FP-6 project SYNLET (Contract Number 043312 to P.F.S. and his lab).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akutsu</surname><given-names>T</given-names></name></person-group><article-title>Dynamic programming algorithms for RNA secondary structure prediction with pseudoknots</article-title><source>Disc. Appl. Math.</source><year>2000</year><volume>104</volume><fpage>45</fpage><lpage>62</lpage></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alkan</surname><given-names>C</given-names></name><etal/></person-group><article-title>RNA-RNA interaction prediction and antisense RNA target search</article-title><source>J. Comput. Biol.</source><year>2006</year><volume>13</volume><fpage>267</fpage><lpage>282</lpage><pub-id pub-id-type="pmid">16597239</pub-id></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andronescu</surname><given-names>M</given-names></name><etal/></person-group><article-title>Secondary structure prediction of interacting RNA molecules</article-title><source>J. Mol. Biol.</source><year>2005</year><volume>345</volume><fpage>1101</fpage><lpage>1112</lpage></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Argaman</surname><given-names>L</given-names></name><name><surname>Altuvia</surname><given-names>S</given-names></name></person-group><article-title><italic>fhlA</italic> repression by <italic>OxyS</italic> RNA: kissing complex formation at two sites results in a stable antisense-target RNA complex</article-title><source>J. Mol. Biol.</source><year>2000</year><volume>300</volume><fpage>1101</fpage><lpage>1112</lpage><pub-id pub-id-type="pmid">10903857</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bachellerie</surname><given-names>J</given-names></name><etal/></person-group><article-title>The expanding snoRNA world</article-title><source>Biochimie</source><year>2002</year><volume>84</volume><fpage>775</fpage><lpage>790</lpage><pub-id pub-id-type="pmid">12457565</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banerjee</surname><given-names>D</given-names></name><name><surname>Slack</surname><given-names>F</given-names></name></person-group><article-title>Control of developmental timing by small temporal RNAs: a paradigm for RNA-mediated regulation of gene expression</article-title><source>Bioessays</source><year>2002</year><volume>24</volume><fpage>119</fpage><lpage>129</lpage><pub-id pub-id-type="pmid">11835276</pub-id></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benne</surname><given-names>R</given-names></name></person-group><article-title>RNA editing in trypanosomes. the use of guide RNAs</article-title><source>Mol. Biol. Rep.</source><year>1992</year><volume>16</volume><fpage>217</fpage><lpage>227</lpage><pub-id pub-id-type="pmid">1454054</pub-id></element-citation></ref><ref id="B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bernhart</surname><given-names>S</given-names></name><etal/></person-group><article-title>Partition function and base pairing probabilities of RNA heterodimers</article-title><source>Algorithms Mol. Biol.</source><year>2006</year><volume>1</volume><fpage>3</fpage><pub-id pub-id-type="pmid">16722605</pub-id></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Busch</surname><given-names>A</given-names></name><etal/></person-group><article-title>IntaRNA: efficient prediction of bacterial sRNA targets incorporating target site accessibility and seed regions</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>2849</fpage><lpage>2856</lpage><pub-id pub-id-type="pmid">18940824</pub-id></element-citation></ref><ref id="B10"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chitsaz</surname><given-names>H</given-names></name><etal/></person-group><article-title>biRNA: fast RNA-RNA binding sites prediction</article-title><source>Proceedings of the 9th Workshop on Algorithms in Bioinformatics (WABI)</source><year>2009a</year><volume>5724</volume><publisher-name>Lectures Notes in Computer Science. Springer</publisher-name><fpage>25</fpage><lpage>36</lpage></element-citation></ref><ref id="B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chitsaz</surname><given-names>H</given-names></name><etal/></person-group><article-title>A partition function algorithm for interacting nucleic acid strands</article-title><source>Bioinformatics</source><year>2009b</year><volume>25</volume><fpage>i365</fpage><lpage>i373</lpage><pub-id pub-id-type="pmid">19478011</pub-id></element-citation></ref><ref id="B12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Lawrence</surname><given-names>CE</given-names></name></person-group><article-title>A statistical sampling algorithm for RNA secondary structure prediction</article-title><source>Nucleic Acid Res.</source><year>2003</year><volume>31</volume><fpage>7280</fpage><lpage>7301</lpage><pub-id pub-id-type="pmid">14654704</pub-id></element-citation></ref><ref id="B13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dirks</surname><given-names>R</given-names></name><etal/></person-group><article-title>Thermodynamic analysis of interacting nucleic acid strands</article-title><source>SIAM Rev.</source><year>2007</year><volume>49</volume><fpage>65</fpage><lpage>88</lpage></element-citation></ref><ref id="B14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dowell</surname><given-names>RD</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>Evaluation of several lightweight stochastic context-free grammars for RNA secondary structure prediction</article-title><source>BMC Bioinformatics</source><year>2004</year><volume>5</volume><fpage>7</fpage><pub-id pub-id-type="pmid">14736340</pub-id></element-citation></ref><ref id="B15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geissmann</surname><given-names>T</given-names></name><name><surname>Touati</surname><given-names>D</given-names></name></person-group><article-title>Hfq, a new chaperoning role: binding to messenger RNA determines access for small RNA regulator</article-title><source>EMBO J.</source><year>2004</year><volume>23</volume><fpage>396</fpage><lpage>405</lpage><pub-id pub-id-type="pmid">14739933</pub-id></element-citation></ref><ref id="B16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Giegerich</surname><given-names>R</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name></person-group><article-title>Algebraic Dynamic Programming</article-title><source>Lecture Notes in Computer Science.</source><year>2002</year><volume>2422</volume><publisher-loc>London</publisher-loc><publisher-name>Springer</publisher-name><fpage>349</fpage><lpage>364</lpage></element-citation></ref><ref id="B17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hekimoglu</surname><given-names>B</given-names></name><name><surname>Ringrose</surname><given-names>L</given-names></name></person-group><article-title>Non-coding RNAs in polycomb/trithorax regulation</article-title><source>RNA Biol.</source><year>2009</year><volume>6</volume><fpage>129</fpage><lpage>137</lpage><pub-id pub-id-type="pmid">19270511</pub-id></element-citation></ref><ref id="B18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hofacker</surname><given-names>IL</given-names></name><etal/></person-group><article-title>Fast folding and comparison of RNA secondary structures</article-title><source>Monatsh. Chem.</source><year>1994</year><volume>125</volume><fpage>167</fpage><lpage>188</lpage></element-citation></ref><ref id="B19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>FWD</given-names></name><etal/></person-group><article-title>Partition function and base pairing probabilities for RNA-RNA interaction prediction</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2646</fpage><lpage>2654</lpage><pub-id pub-id-type="pmid">19671692</pub-id></element-citation></ref><ref id="B20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kugel</surname><given-names>J</given-names></name><name><surname>Goodrich</surname><given-names>J</given-names></name></person-group><article-title>An RNA transcriptional regulator templates its own regulatory RNA</article-title><source>Nat. Struct. Mol. Biol.</source><year>2007</year><volume>3</volume><fpage>89</fpage><lpage>90</lpage></element-citation></ref><ref id="B21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCaskill</surname><given-names>JS</given-names></name></person-group><article-title>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</article-title><source>Biopolymers</source><year>1990</year><volume>29</volume><fpage>1105</fpage><lpage>1119</lpage><pub-id pub-id-type="pmid">1695107</pub-id></element-citation></ref><ref id="B22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McManus</surname><given-names>MT</given-names></name><name><surname>Sharp</surname><given-names>PA</given-names></name></person-group><article-title>Gene silencing in mammals by small interfering RNAs</article-title><source>Nat. Rev.</source><year>2002</year><volume>3</volume><fpage>737</fpage><lpage>747</lpage></element-citation></ref><ref id="B23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mneimneh</surname><given-names>S</given-names></name></person-group><article-title>On the approximation of optimal structures for RNA-RNA interaction</article-title><source>IEEE/ACM Trans. Comp. Biol. Bioinform.</source><year>2009</year><volume>6</volume><fpage>682</fpage><lpage>688</lpage></element-citation></ref><ref id="B24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>M&#x000fc;ckstein</surname><given-names>U</given-names></name><etal/></person-group><article-title>Thermodynamics of RNA-RNA binding</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>1177</fpage><lpage>1182</lpage><pub-id pub-id-type="pmid">16446276</pub-id></element-citation></ref><ref id="B25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>M&#x000fc;ckstein</surname><given-names>U</given-names></name><etal/></person-group><person-group person-group-type="editor"><name><surname>Elloumi</surname><given-names>M</given-names></name><etal/></person-group><article-title>Translational control by RNA-RNA interaction: improved computation of RNA-RNA binding thermodynamics</article-title><source>Bioinformatics Research and Development &#x02014; BIRD 2008</source><year>2008</year><volume>13</volume><publisher-loc>Berlin</publisher-loc><publisher-name>Communication in Computer and Information Science. Springer</publisher-name><fpage>114</fpage><lpage>127</lpage></element-citation></ref><ref id="B26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Narberhaus</surname><given-names>F</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name></person-group><article-title>Sensory and regulatory RNAs in prokaryotes: A new german research focus</article-title><source>RNA Biol.</source><year>2007</year><volume>4</volume><fpage>160</fpage><lpage>164</lpage><pub-id pub-id-type="pmid">18059194</pub-id></element-citation></ref><ref id="B27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pervouchine</surname><given-names>D</given-names></name></person-group><article-title><monospace>IRIS</monospace>: intermolecular RNA interaction search</article-title><source>Proc. Genome Inform.</source><year>2004</year><volume>15</volume><fpage>92</fpage><lpage>101</lpage></element-citation></ref><ref id="B28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Reidys</surname><given-names>CM</given-names></name></person-group><article-title>A combinatorial framework for RNA tertiary interaction</article-title><source>Technical Report 0710.3523, arXiv.</source><year>2007</year><comment>Available at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/PS_cache/arxiv/pdf/0710/0710.3523v3.pdf">http://arxiv.org/PS_cache/arxiv/pdf/0710/0710.3523v3.pdf</ext-link></comment></element-citation></ref><ref id="B29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rehmsmeier</surname><given-names>M</given-names></name><etal/></person-group><article-title>Fast and effective prediction of microRNA/target duplexes</article-title><source>Gene</source><year>2004</year><volume>10</volume><fpage>1507</fpage><lpage>1517</lpage></element-citation></ref><ref id="B30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivas</surname><given-names>E</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>A dynamic programming algorithms for RNA structure prediction including pseudoknots</article-title><source>J. Mol. Biol.</source><year>1999</year><volume>285</volume><fpage>2053</fpage><lpage>2068</lpage><pub-id pub-id-type="pmid">9925784</pub-id></element-citation></ref><ref id="B31"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Salari</surname><given-names>R</given-names></name><etal/></person-group><article-title>Fast prediction of RNA-RNA interaction</article-title><source>Proceedings of the 9th Workshop on Algorithms in Bioinformatics (WABI)</source><year>2009</year><volume>5724</volume><publisher-name>Lecture Notes in Computer Science. Springer</publisher-name><fpage>261</fpage><lpage>272</lpage></element-citation></ref><ref id="B32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tacker</surname><given-names>M</given-names></name><etal/></person-group><article-title>Algorithm independent properties of RNA structure prediction</article-title><source>Eur. Biophy. J.</source><year>1996</year><volume>25</volume><fpage>115</fpage><lpage>130</lpage></element-citation></ref><ref id="B33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tafer</surname><given-names>H</given-names></name><etal/></person-group><article-title><monospace>RNAsnoop</monospace>: efficient target prediction for box H/ACA snoRNAs</article-title><source>Bioinformatics</source><year>2009</year><comment>University of Leipzig. Available at <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Publications/PREPRINTS/09-025.pdf">http://www.bioinf.uni-leipzig.de/Publications/PREPRINTS/09-025.pdf</ext-link></comment></element-citation></ref><ref id="B34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tjaden</surname><given-names>B</given-names></name><etal/></person-group><article-title>Target prediction for small, noncoding RNAs in bacteria</article-title><source>Nucleic Acids Res.</source><year>2006</year><volume>34</volume><fpage>2791</fpage><lpage>2802</lpage><pub-id pub-id-type="pmid">16717284</pub-id></element-citation></ref><ref id="B35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Udekwu</surname><given-names>K</given-names></name><etal/></person-group><article-title>Hfq-dependent regulation of OmpA synthesis is mediated by an antisense RNA</article-title><source>Genes Dev.</source><year>2005</year><volume>19</volume><fpage>2355</fpage><lpage>2366</lpage><pub-id pub-id-type="pmid">16204185</pub-id></element-citation></ref><ref id="B36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urban</surname><given-names>JH</given-names></name><name><surname>Vogel</surname><given-names>J</given-names></name></person-group><article-title>Translational control and target recognition by <italic>Escherichia coli</italic> small RNAs <italic>in vivo</italic></article-title><source>Nucleic Acids Res.</source><year>2007</year><volume>35</volume><fpage>1018</fpage><lpage>1037</lpage><pub-id pub-id-type="pmid">17264113</pub-id></element-citation></ref><ref id="B37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zuker</surname><given-names>M</given-names></name><name><surname>Sankoff</surname><given-names>D</given-names></name></person-group><article-title>RNA secondary structures and their prediction</article-title><source>Bull. Math. Biol.</source><year>1984</year><volume>46</volume><fpage>591</fpage><lpage>621</lpage></element-citation></ref></ref-list></back></article>