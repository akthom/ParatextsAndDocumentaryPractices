<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19417059</article-id><article-id pub-id-type="pmc">2712337</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btp300</article-id><article-id pub-id-type="publisher-id">btp300</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Structural Bioinformatics</subject></subj-group></subj-group></article-categories><title-group><article-title>Ulla: a program for calculating environment-specific amino acid substitution tables</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lee</surname><given-names>Semin</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Blundell</surname><given-names>Tom L.</given-names></name></contrib></contrib-group><aff id="AFF1">Department of Biochemistry, University of Cambridge, 80 Tennis Court Road, Old Addenbrooke's Site, Cambridge CB2 1GA, UK</aff><author-notes><corresp id="COR1">* To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Anna Tramontano</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>8</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>5</day><month>5</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>5</day><month>5</month><year>2009</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>25</volume><issue>15</issue><fpage>1976</fpage><lpage>1977</lpage><history><date date-type="received"><day>17</day><month>3</month><year>2009</year></date><date date-type="rev-recd"><day>18</day><month>4</month><year>2009</year></date><date date-type="accepted"><day>28</day><month>4</month><year>2009</year></date></history><permissions><copyright-statement>&#x000a9; 2009 The Author(s)</copyright-statement><copyright-year>2009</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Summary:</bold> Amino acid residues are under various kinds of local environmental restraints, which influence substitution patterns. Ulla,<xref ref-type="fn" rid="FN1"><sup>1</sup></xref> a program for calculating environment-specific substitution tables, reads protein sequence alignments and local environment annotations. The program produces a substitution table for every possible combination of environment features. Sparse data is handled using an entropy-based smoothing procedure to estimate robust substitution probabilities.</p><p><bold>Availability:</bold> The Ruby source code is available under a Creative Commons Attribution-Noncommercial License along with additional documentation from <ext-link ext-link-type="uri" xlink:href="http://www-cryst.bioc.cam.ac.uk/ulla">http://www-cryst.bioc.cam.ac.uk/ulla</ext-link>.</p><p><bold>Contact:</bold> <email>semin@cryst.bioc.cam.ac.uk</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp300/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>In the evolution of proteins, individual amino acid residues are under various kinds of local environmental restraints such as secondary structure type, solvent accessibility and hydrogen bonding patterns. Previous study of amino acid substitutions as a function of local environment has showed that there are clear differences among substitution patterns under various environmental restraints (Overington <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">1992</xref>). The unique patterns of amino acid substitutions have been successfully exploited to predict the stability of protein mutants (Topham <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">1993</xref>), to identify potential interaction sites (Chelliah <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2004</xref>; Gong and Blundell, <xref ref-type="bibr" rid="B3">2008</xref>) and to detect remote sequence-structure homology (Chelliah <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2005</xref>).</p><p>However, estimating amino acid substitution probabilities is not a trivial problem, especially when there are a very small number of observations in specific combinations of environments. To cope with the sparse data problem, an algorithm was developed by Sali (<xref ref-type="bibr" rid="B8">1991</xref>) as an extension of the method used by Sippl (<xref ref-type="bibr" rid="B9">1990</xref>) to derive robust potentials of mean force. Several variants of the generalized procedure such as Makesub (Topham <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">1993</xref>) and SUBST (Mizuguchi, unpublished results) have been subsequently implemented for smoothing substitution probabilities. Nevertheless, each lacks crucial features implemented in the other, and they use slightly different procedures for smoothing substitution probabilities, which may lead to very different amino acid substitution matrices.</p><p>To overcome these problems, we developed Ulla, a program for calculating environment-specific substitution tables (ESSTs), to unify all the major features of the previously developed programs and to provide additional functionalities. The program also generates heat maps from substitution tables to visualize the degree of conservation of amino acids under the environmental restraints.</p></sec><sec id="SEC2"><title>2 DESCRIPTION</title><p>Ulla reads multiple sequence alignments and annotations for local environments in JOY template format (Mizuguchi <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">1998a</xref>). Users can provide their own definition of environment features, and an environment feature can be constrained to count substitutions only when the environment of residues is conserved. Ulla also supports confining percent identity (PID) range of sequence pairs to be considered and uses BLOSUM-like weighting scheme (Henikoff and Henikoff, <xref ref-type="bibr" rid="B4">1992</xref>) to minimize sampling bias from highly similar sequences.</p><p>Ulla uses entropy-based smoothing procedures to reduce problems caused by sparse data. It is an iterative procedure that estimates probability distribution by perturbing the previous probability distribution with the successive measurement (Sali, <xref ref-type="bibr" rid="B8">1991</xref>; Sippl, <xref ref-type="bibr" rid="B9">1990</xref>). Hence, starting from a uniform frequency distribution, the estimated probability distribution at each step serves as an approximation for the next probability distribution (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp300/DC1">Supplementary Material</ext-link> for details).</p></sec><sec id="SEC3"><title>3 EXAMPLE USAGE</title><p>As an illustration, we generate ESSTs from HOMSTRAD alignments (Mizuguchi <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">1998b</xref>) with environment feature definitions of secondary structure type and solvent accessibility (<xref ref-type="fig" rid="F1">Fig. 1</xref>a):
<list list-type="simple"><list-item><p><monospace># name of feature (string);\\</monospace></p></list-item><list-item><p><monospace># values adopted in .tem (alignment) file (string);\\</monospace></p></list-item><list-item><p><monospace># class labels assigned for each value (string);\\</monospace></p></list-item><list-item><p><monospace># constrained or not (T or F);\\</monospace></p></list-item><list-item><p><monospace># silent (used as masks)? (T or F) secondary structure and phi angle;HEPC;HEPC;F;F solvent accessibility;TF;Aa;F;F</monospace></p></list-item></list>
Actual annotations for the environment features need to be provided in PIR format:
<inline-graphic xlink:href="btp300i1.jpg"/></p><p>JOY (Mizuguchi <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">1998a</xref>) is useful to annotate the alignments with the structural environments, but Ulla recognizes any environment feature definition which conforms to the format above. Paths for an environment definition file and a file containing the list of environment feature annotated alignments are given to Ulla as input:
<list list-type="simple"><list-item><p><monospace>$ ulla -c feature.def -l alignments.lst</monospace></p></list-item></list>
Ulla produces three different types of substitution tables: raw counts tables, substitution probability tables and log-odds ratio tables. Heat maps also can be generated to visualize resultant substitution tables (<xref ref-type="fig" rid="F1">Fig. 1</xref>b).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Environment feature combinations and ESST generation. (<bold>a</bold>) The environment features are secondary structure type (H: helix, E: beta sheet, P: positive phi, C: coil) and solvent accessibility (A: solvent accessible, a: solvent inaccessible). Eight sets of combinations of environment features are generated. (<bold>b</bold>) Heat maps from each of resultant ESSTs. Blue to red indicates log-odds ratio of substitution probabilities.</p></caption><graphic xlink:href="btp300f1"/></fig>
</p></sec><sec sec-type="conclusions" id="SEC4"><title>4 CONCLUSION</title><p>Ulla generates ESSTs from a sparse data set using entropy-based smoothing procedures. It allows us to conduct analyses of amino acid substitution patterns under various environmental restraints. The resultant ESSTs can be exploited in many ways such as binding site prediction, remote homology detection, and protein stability estimation.</p><p>Ulla is publicly available on the web site <ext-link ext-link-type="uri" xlink:href="http://github.com/semin/ulla">http://github.com/semin/ulla</ext-link>, where the code is maintained in a Git repository, and its pre-built RubyGems package can be obtained from <ext-link ext-link-type="uri" xlink:href="http://rubyforge.org/projects/ulla">http://rubyforge.org/projects/ulla</ext-link>.</p></sec></body><back><fn-group><fn id="FN1"><p><sup>1</sup>Ulla is a traditional Korean percussion instrument.</p></fn></fn-group><ack><title>ACKNOWLEDGEMENTS</title><p>We thank Juok Cho for statistical advice; Dan Bolser and Duangrudee Tanramluk for review of the manuscript; Richard Bickerton and Bernardo Ochoa for thorough beta testing.</p><p><italic>Funding</italic>: Mogam Science Scholarship Foundation (to S.L., partial); The Wellcome Trust (to T.L.B.)</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chelliah</surname><given-names>V</given-names></name><etal/></person-group><article-title>Distinguishing structural and functional restraints in evolution in order to identify interaction sites</article-title><source>J. Mol. Biol.</source><year>2004</year><volume>342</volume><fpage>1487</fpage><lpage>1504</lpage><pub-id pub-id-type="pmid">15364576</pub-id></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chelliah</surname><given-names>V</given-names></name><etal/></person-group><article-title>Functional restraints on the patterns of amino acid substitutions: application to sequence-structure homology recognition</article-title><source>Proteins</source><year>2005</year><volume>61</volume><fpage>722</fpage><lpage>731</lpage><pub-id pub-id-type="pmid">16193489</pub-id></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>S</given-names></name><name><surname>Blundell</surname><given-names>TL</given-names></name></person-group><article-title>Discarding functional residues from the substitution table improves predictions of active sites within three-dimensional structures</article-title><source>PLoS Comput. Biol.</source><year>2008</year><volume>4</volume><fpage>e1000179</fpage><pub-id pub-id-type="pmid">18833291</pub-id></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>S</given-names></name><name><surname>Henikoff</surname><given-names>JG</given-names></name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1992</year><volume>89</volume><fpage>10915</fpage><lpage>10919</lpage><pub-id pub-id-type="pmid">1438297</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuguchi</surname><given-names>K</given-names></name><etal/></person-group><article-title>JOY: protein sequence-structure representation and analysis</article-title><source>Bioinformatics</source><year>1998a</year><volume>14</volume><fpage>617</fpage><lpage>623</lpage><pub-id pub-id-type="pmid">9730927</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mizuguchi</surname><given-names>K</given-names></name><etal/></person-group><article-title>HOMSTRAD: a database of protein structure alignments for homologous families</article-title><source>Protein Sci.</source><year>1998b</year><volume>7</volume><fpage>2469</fpage><lpage>2471</lpage><pub-id pub-id-type="pmid">9828015</pub-id></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overington</surname><given-names>J</given-names></name><etal/></person-group><article-title>Environment-specific amino acid substitution tables: tertiary templates and prediction of protein folds</article-title><source>Protein Sci.</source><year>1992</year><volume>1</volume><fpage>216</fpage><lpage>226</lpage><pub-id pub-id-type="pmid">1304904</pub-id></element-citation></ref><ref id="B8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sali</surname><given-names>A</given-names></name></person-group><article-title>Modelling three-dimensional structure of proteins from their sequence of amino acid residues</article-title><source>PhD Thesis</source><year>1991</year><publisher-loc>London</publisher-loc><publisher-name>University of London</publisher-name></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sippl</surname><given-names>MJ</given-names></name></person-group><article-title>Calculation of conformational ensembles from potentials of mean force. An approach to the knowledge-based prediction of local structures in globular proteins</article-title><source>J. Mol. Biol.</source><year>1990</year><volume>213</volume><fpage>859</fpage><lpage>883</lpage><pub-id pub-id-type="pmid">2359125</pub-id></element-citation></ref><ref id="B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Topham</surname><given-names>CM</given-names></name><etal/></person-group><article-title>Fragment ranking in modelling of protein structure. Conformationally constrained environmental amino acid substitution tables</article-title><source>J. Mol. Biol.</source><year>1993</year><volume>229</volume><fpage>194</fpage><lpage>220</lpage><pub-id pub-id-type="pmid">8421300</pub-id></element-citation></ref></ref-list></back></article>